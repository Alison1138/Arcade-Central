<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Jogo da Cobrinha</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: #222;
    }

    body {
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding-top: 25px;
    }

    h1 {
      margin: 0 0 15px 0;
      font-size: 28px;
    }

    .controls-container {
      display: flex;
      gap: 12px;
      margin-bottom: 15px;
    }

    .score {
      font-size: 18px;
      margin-bottom: 10px;
    }

    .board {
      display: grid;
      grid-template-columns: repeat(20, 22px);
      grid-template-rows: repeat(20, 22px);
      gap: 1px;
      background: #444;
      padding: 3px;
      border: 3px solid #333;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }

    .cell {
      width: 22px;
      height: 22px;
      background: #111;
    }

    .snake {
      background: limegreen;
      border-radius: 2px;
    }

    .food {
      background: crimson;
      border-radius: 50%; /* Comida arredondada para destacar */
    }

    .btn {
      padding: 10px 22px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      font-size: 16px;
      transition: transform 0.1s, opacity 0.2s;
    }

    .btn:active {
      transform: scale(0.95);
    }

    .btn-restart {
      background: limegreen;
      color: #000;
    }

    .btn-exit {
      background: #e74c3c;
      color: white;
    }

    /* Tela de Instru√ß√µes */
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .modal {
      background: #333;
      padding: 35px;
      border-radius: 12px;
      text-align: center;
      border: 2px solid limegreen;
      max-width: 320px;
    }

    .modal h2 {
      margin-top: 0;
      color: limegreen;
      font-size: 24px;
    }

    .modal ul {
      text-align: left;
      margin: 20px 0;
      font-size: 16px;
      line-height: 1.6;
    }
  </style>
</head>
<body>

<div id="overlay">
  <div class="modal">
    <h2>Como Jogar</h2>
    <ul>
      <li>Use as <b>setas do teclado</b> para mover a cobra.</li>
      <li>Coma os quadrados <b>vermelhos</b> para crescer.</li>
      <li>N√£o bata nas <b>paredes</b> ou no corpo.</li>
    </ul>
    <button class="btn btn-restart" onclick="closeInstructions()">Come√ßar Jogo</button>
  </div>
</div>

<h1>üêç Jogo da Cobrinha</h1>

<div class="controls-container">
    <button class="btn btn-restart" onclick="resetGame()">Reiniciar</button>
    <button class="btn btn-exit" onclick="window.close()">Sair do Jogo</button>
</div>

<div class="score">Pontua√ß√£o: <span id="score">0</span></div>
<div id="board" class="board"></div>

<script>
  const SIZE = 20;
  const board = document.getElementById("board");
  const scoreElement = document.getElementById("score");
  const overlay = document.getElementById("overlay");

  let snake;
  let direction;
  let food;
  let score;
  let gameInterval;
  let gameStarted = false;

  function closeInstructions() {
    overlay.style.display = "none";
    startGame();
  }

  function startGame() {
    clearInterval(gameInterval);
    board.innerHTML = "";

    for (let i = 0; i < SIZE * SIZE; i++) {
      const cell = document.createElement("div");
      cell.classList.add("cell");
      board.appendChild(cell);
    }

    snake = [{ x: 10, y: 10 }];
    direction = null;
    score = 0;
    gameStarted = false;
    scoreElement.textContent = score;

    spawnFood();
    draw();
  }

  function resetGame() {
    startGame();
  }

  function startLoop() {
    if (!gameStarted) {
      gameStarted = true;
      gameInterval = setInterval(gameLoop, 130); // Velocidade ligeiramente aumentada
    }
  }

  function gameLoop() {
    if (!direction) return;

    const head = {
      x: snake[0].x + direction.x,
      y: snake[0].y + direction.y
    };

    if (head.x < 0 || head.x >= SIZE || head.y < 0 || head.y >= SIZE) {
      gameOver();
      return;
    }

    for (let part of snake) {
      if (part.x === head.x && part.y === head.y) {
        gameOver();
        return;
      }
    }

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y) {
      score++;
      scoreElement.textContent = score;
      spawnFood();
    } else {
      snake.pop();
    }

    draw();
  }

  function draw() {
    const cells = board.children;
    for(let cell of cells) {
        cell.className = "cell";
    }

    snake.forEach(part => {
      const index = part.y * SIZE + part.x;
      if(cells[index]) cells[index].classList.add("snake");
    });

    const foodIndex = food.y * SIZE + food.x;
    if(cells[foodIndex]) cells[foodIndex].classList.add("food");
  }

  function spawnFood() {
    let valid = false;
    while (!valid) {
      food = {
        x: Math.floor(Math.random() * SIZE),
        y: Math.floor(Math.random() * SIZE)
      };
      valid = !snake.some(part => part.x === food.x && part.y === food.y);
    }
  }

  function gameOver() {
    clearInterval(gameInterval);
    alert("Game Over! Pontua√ß√£o: " + score);
    startGame();
  }

  document.addEventListener("keydown", e => {
    if (overlay.style.display === "none") {
        if (["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].includes(e.key)) {
          e.preventDefault();
        }

        let newDirection = null;
        switch (e.key) {
          case "ArrowUp":
            if (!direction || direction.y === 0) newDirection = { x: 0, y: -1 };
            break;
          case "ArrowDown":
            if (!direction || direction.y === 0) newDirection = { x: 0, y: 1 };
            break;
          case "ArrowLeft":
            if (!direction || direction.x === 0) newDirection = { x: -1, y: 0 };
            break;
          case "ArrowRight":
            if (!direction || direction.x === 0) newDirection = { x: 1, y: 0 };
            break;
        }

        if (newDirection) {
          direction = newDirection;
          startLoop();
        }
    }
  });
</script>

</body>
</html>